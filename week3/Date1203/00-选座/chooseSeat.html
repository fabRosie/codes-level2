<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="x-ua-compatible" content="ie=7" />
<meta name="" content="" />
<title></title>
<link href="css/css_whir.css" rel="stylesheet" type="text/css" />
</head>

<body>

<div class="Content">
<!--/*内容*/-->

<!--/*订票信息*/-->
<!--/*订票信息 end*/-->
<!--/*订票座位*/-->
<div class="book_step_main">
<div class="book_step_left">
<div class="gray"></div>
<!--/**/-->
<div class="sitting">
<h5>银幕</h5>
<div class="sitting_list">
<dl class="row row1">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row2">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="kx" ></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row3">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row4">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row5">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="ys"></div></dd>
<dd><div  class="ys"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row6">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row7">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row8">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row9">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row10">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
<dl class="row row11">
<dd><div class="nosit"></div></dd>
<dd><div class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx" ></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="kx"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
<dd><div  class="nosit"></div></dd>
</dl>
</div>
</div>
<!--/**/-->
</div>
<div class="book_step_right">
<h1>选择座位</h1>
<div class="select_sit">
<dl>
<dd>可选座位</dd>
<dd class="yx">已选座位</dd>
<dd class="ys">已售座位</dd>
</dl>
<div class="clear"></div>
<h5>单击左侧座位图选择座位，再次单击座位取消选择。</h5>
<ul class="selected">
  <!-- 新增ol标签 -->
  <!-- <ol>4排3座</ol> -->
</ul>
<div class="clear"></div>
</div>
<h1>请输入取票的手机号码</h1>
<div class="select_sit">
<table cellpadding="0" cellspacing="0" border="0">
<tr><td>手机号码</td></tr>
<tr><td><input type="text" class="text" /></td></tr>
<tr><td>验证码</td></tr>
<tr><td><input type="text" class="text" style="width:90px;" /><img src="images/code2.jpg" width="60"  height="24"/><span>看不清，换一张。</span></td></tr>
<tr><td><input type="button" class="btn" id="gopay" value="立即购票" /></td></tr>
</table>
</div>
</div>
<div class="clear"></div>
</div>
<!--/*订票座位 end*/-->
<div class="Booktips">
<h5>使用说明：</h5>
<p>1、选择你要预订的座位单击选中，重复点击取消所选座位。<br />
2、每笔订单最多可选购4张电影票。<br />
3、每人每天限购3次。<br />
4、选座时，请尽量选择相邻座位，请不要留下单个座位。<br />
5、点击“立即购票”进入付款页面后，请在15分钟内完成支付，超时系统将释放你选定的座位。<br />
6、开场前三小时内无法执行退票操作。</p>
</div>
<!--/*内容 end*/-->
</div>

<script>
    /*
    说明： class:    ys(已售)  kx(空闲)  yx（已选）
    功能：
    1. 点击空闲座位，可以切换为已选
    2. 点击已选，切换为空闲
    3. 在空闲座位切换至已选时，页面右边会出现已选的座位号，x排x列
    4. 在已选座位切换至空闲时，页面右边对应已选的座位消失
    */
    //1 2 设置点击事件，切换class
    
    //3  核心；获取点击位置的座位号
    // 在点击时先获取第几排：再找到该座位的下标（位置）

    // 1. 点击 切换空闲 已选
    var seats = document.querySelectorAll('.sitting_list .kx');
    // 依次的给这些div设置点击事件
    for(var i=0;i<seats.length;i++){
      var s = seats[i];//获取某个座位div标签
      s.onclick = function(){
        //对自己的 class进行判断，yx 和kx 切换
        //扩展：数量不能超过4个。
        var chooseSeats = document.querySelectorAll('.sitting_list .yx');
        //console.log(chooseSeats);
        var classname = this.getAttribute("class");
        if(classname=='kx'){
          if(chooseSeats.length<4){
            this.setAttribute('class','yx');
          }else{
            alert("最多选择4个位置");
            return;
          }
        }else if(classname=='yx'){
          this.setAttribute('class','kx');
        }

        // 2 显示几排几座
        //获取几排 :获取dl祖先标签的class，截取获得排号 
        var dl = this.parentElement.parentElement;
        var dlClass =dl.getAttribute('class');
        var line = dlClass.substr(7);
        //获取几座:通过祖先元素dl，找到所有 的座位，遍历.
        //对比是否等于当前点击的标签，以此来获取被点击的下标
        var divs  = document.querySelectorAll(`.row.row${line} .kx,.row.row${line} .yx,.row.row${line} .ys`);
        var number;
        //遍历divs，找到被点击的div，获取下标
        for(var i=0;i<divs.length;i++){
          if(this == divs[i]){
            number =i+1;//几列，
          }
        }
        // console.log(`${line}排${number}列`);

         // 3 如果是空闲转已选：放在页面上:新建ol标签，放在ul上
         if(this.getAttribute('class')=='yx'){
          var ol = document.createElement('ol');
         var ul = document.querySelector('.selected');
         //设置文本内容
         ol.innerText = `${line}排${number}列`;
         //添加
         ul.appendChild(ol);
         }else{
           //通过遍历所有的ol来找到当前该几排几列，再remove掉
           var ols= document.querySelectorAll(".selected ol");

           for(var i=0;i<ols.length;i++){
             var olText = ols[i].innerText;
             if(olText==`${line}排${number}列`){
               //删除
               ols[i].parentElement.removeChild(ols[i]);
               break;
             }
           }
           
         }

         // 
      }
    }

    

</script>

</body>
</html>
